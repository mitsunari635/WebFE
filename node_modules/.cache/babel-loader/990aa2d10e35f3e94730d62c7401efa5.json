{"ast":null,"code":"var _jsxFileName = \"D:\\\\LienSon\\\\LienSon-FE\\\\src\\\\containers\\\\System\\\\Admin\\\\ProductRedux.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../store/actions\";\nimport \"./ProductRedux.scss\";\nimport Lightbox from \"react-image-lightbox\";\nimport \"react-image-lightbox/style.css\";\nimport TableManageProduct from \"./TableManageProduct\";\nimport { CRUD_ACTIONS, CommonUtils } from \"../../../utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass ProductRedux extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleOnChangeImage = async event => {\n      let data = event.target.files;\n      let file = data[0];\n\n      if (file) {\n        let base64 = await CommonUtils.getBase64(file);\n        let objectUrl = URL.createObjectURL(file);\n        this.setState({\n          previewImgUrl: objectUrl,\n          image: base64\n        });\n      }\n    };\n\n    this.handleOnChangeSecondImage = async event => {\n      let data = event.target.files;\n      let file = data[0];\n\n      if (file) {\n        let secondBase64 = await CommonUtils.getBase64(file);\n        let secondObjectUrl = URL.createObjectURL(file);\n        this.setState({\n          secondPreviewImgUrl: secondObjectUrl,\n          secondImage: secondBase64\n        });\n      }\n    };\n\n    this.handleOnChangeThirdImage = async event => {\n      let data = event.target.files;\n      let file = data[0];\n\n      if (file) {\n        let thirdBase64 = await CommonUtils.getBase64(file);\n        let thirdObjectUrl = URL.createObjectURL(file);\n        this.setState({\n          thirdPreviewImgUrl: thirdObjectUrl,\n          thirdImage: thirdBase64\n        });\n      }\n    };\n\n    this.openPreviewImage = () => {\n      if (!this.state.previewImgUrl) return;\n      this.setState({\n        isOpen: true\n      });\n    };\n\n    this.openPreviewSecondImage = () => {\n      if (!this.state.secondPreviewImgUrl) return;\n      this.setState({\n        isOpen: true\n      });\n    };\n\n    this.openPreviewThirdImage = () => {\n      if (!this.state.thirdPreviewImgUrl) return;\n      this.setState({\n        isOpen: true\n      });\n    };\n\n    this.handleSaveProduct = () => {\n      let isValid = this.checkValidateInput();\n      if (isValid === false) return;\n      let {\n        action\n      } = this.state;\n\n      if (action === CRUD_ACTIONS.CREATE) {\n        //fire redux create\n        this.props.createNewProduct({\n          name: this.state.name,\n          price: this.state.price,\n          discount: this.state.discount,\n          describe: this.state.describe,\n          stockId: this.state.stock,\n          type: this.state.type,\n          image: this.state.image,\n          secondImage: this.state.secondImage,\n          thirdImage: this.state.thirdImage\n        });\n      }\n\n      if (action === CRUD_ACTIONS.EDIT) {\n        //fire redux edit\n        this.props.editProductRedux({\n          id: this.state.productEditId,\n          name: this.state.name,\n          price: this.state.price,\n          discount: this.state.discount,\n          describe: this.state.describe,\n          stockId: this.state.stock,\n          type: this.state.type,\n          image: this.state.image,\n          secondImage: this.state.secondImage,\n          thirdImage: this.state.thirdImage\n        });\n      }\n    };\n\n    this.checkValidateInput = () => {\n      let isValid = true;\n      let arrCheck = [\"name\", \"price\", \"describe\", \"type\"];\n\n      for (let i = 0; i < arrCheck.length; i++) {\n        if (!this.state[arrCheck[i]]) {\n          isValid = false;\n          alert(\"Thông tin không được để trống: \" + arrCheck[i]);\n          break;\n        }\n      }\n\n      return isValid;\n    };\n\n    this.onChangeInput = (event, id) => {\n      let copyState = { ...this.state\n      };\n      copyState[id] = event.target.value;\n      this.setState({ ...copyState\n      });\n    };\n\n    this.handleEditProductFromParent = product => {\n      let imageBase64 = \"\";\n      let secondImageBase64 = \"\";\n      let thirdImageBase64 = \"\";\n\n      if (product.image) {\n        imageBase64 = new Buffer.from(product.image, \"base64\").toString(\"binary\");\n      }\n\n      if (product.secondImage) {\n        secondImageBase64 = new Buffer.from(product.secondImage, \"secondBase64\").toString(\"binary\");\n      }\n\n      if (product.thirdImage) {\n        thirdImageBase64 = new Buffer.from(product.thirdImage, \"thirdBase64\").toString(\"binary\");\n      }\n\n      this.setState({\n        name: product.name,\n        price: product.price,\n        discount: product.discount,\n        describe: product.describe,\n        stock: product.stockId,\n        type: product.type,\n        image: imageBase64,\n        secondImage: secondImageBase64,\n        thirdImage: thirdImageBase64,\n        previewImgUrl: imageBase64,\n        secondPreviewImgUrl: secondImageBase64,\n        thirdPreviewImgUrl: thirdImageBase64,\n        action: CRUD_ACTIONS.EDIT,\n        productEditId: product.id\n      });\n    };\n\n    this.state = {\n      stockArr: [],\n      previewImgUrl: \"\",\n      secondPreviewImgUrl: \"\",\n      thirdPreviewImgUrl: \"\",\n      name: \"\",\n      price: \"\",\n      discount: \"0\",\n      stock: \"\",\n      describe: \"\",\n      type: \"\",\n      image: \"\",\n      secondImage: \"\",\n      thirdImage: \"\",\n      action: \"\",\n      productEditId: \"\"\n    };\n  }\n\n  async componentDidMount() {\n    this.props.getStockStart();\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (prevProps.stockRedux !== this.props.stockRedux) {\n      let arrStocks = this.props.stockRedux;\n      this.setState({\n        stockArr: this.props.stockRedux,\n        stock: arrStocks && arrStocks.length > 0 ? arrStocks[0].keyMap : \"\"\n      });\n    }\n\n    if (prevProps.listProducts !== this.props.listProducts) {\n      let arrStocks = this.props.stockRedux;\n      this.setState({\n        name: \"\",\n        price: \"\",\n        discount: \"0\",\n        describe: \"\",\n        stock: arrStocks && arrStocks.length > 0 ? arrStocks[0].keyMap : \"\",\n        type: \"\",\n        image: \"\",\n        secondImage: \"\",\n        thirdImage: \"\",\n        action: CRUD_ACTIONS.CREATE,\n        previewImgUrl: \"\",\n        secondPreviewImgUrl: \"\",\n        thirdPreviewImgUrl: \"\"\n      });\n    }\n  }\n\n  render() {\n    let stocks = this.state.stockArr;\n    let {\n      name,\n      price,\n      discount,\n      describe,\n      stock,\n      type\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-redux-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title\",\n        children: \"Qu\\u1EA3n l\\xFD s\\u1EA3n ph\\u1EA9m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: \"Th\\xEAm s\\u1EA3n ph\\u1EA9m\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"T\\xEAn s\\u1EA3n ph\\u1EA9m: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: name,\n                onChange: event => {\n                  this.onChangeInput(event, \"name\");\n                } // disabled={this.state.action === CRUD_ACTIONS.EDIT ? true : false}\n\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Gi\\xE1 ti\\u1EC1n: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: price,\n                onChange: event => {\n                  this.onChangeInput(event, \"price\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Gi\\xE1 khuy\\u1EBFn m\\xE3i: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: discount,\n                onChange: event => {\n                  this.onChangeInput(event, \"discount\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Lo\\u1EA1i gi\\u1EA5y: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: type,\n                onChange: event => {\n                  this.onChangeInput(event, \"type\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Kho ch\\u1EE9a: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"form-control\",\n                value: stock,\n                onChange: event => {\n                  this.onChangeInput(event, \"stock\");\n                },\n                children: stocks && stocks.length > 0 && stocks.map((item, index) => {\n                  return /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: item.keyMap,\n                    children: item.valueVi\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 296,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"\\u0110\\u01A1n v\\u1ECB t\\xEDnh: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: describe,\n                onChange: event => {\n                  this.onChangeInput(event, \"describe\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"H\\xECnh \\u1EA3nh 1: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"preview-img-container\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"previewImg\",\n                  type: \"file\",\n                  hidden: true,\n                  onChange: event => this.handleOnChangeImage(event)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"label-upload\",\n                  htmlFor: \"previewImg\",\n                  children: [\"T\\u1EA3i \\u1EA3nh\", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-upload\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 326,\n                    columnNumber: 28\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"preview-img\",\n                  style: {\n                    backgroundImage: `url(${this.state.previewImgUrl})`\n                  },\n                  onClick: () => this.openPreviewImage()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"H\\xECnh \\u1EA3nh 2: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"preview-img-container\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"secondPreviewImg\",\n                  type: \"file\",\n                  hidden: true,\n                  onChange: event => this.handleOnChangeSecondImage(event)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"label-upload\",\n                  htmlFor: \"secondPreviewImg\",\n                  children: [\"T\\u1EA3i \\u1EA3nh\", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-upload\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 28\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 347,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"preview-img\",\n                  style: {\n                    backgroundImage: `url(${this.state.secondPreviewImgUrl})`\n                  },\n                  onClick: () => this.openPreviewSecondImage()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 350,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"H\\xECnh \\u1EA3nh 3: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"preview-img-container\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"thirdPreviewImg\",\n                  type: \"file\",\n                  hidden: true,\n                  onChange: event => this.handleOnChangeThirdImage(event)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 363,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"label-upload\",\n                  htmlFor: \"thirdPreviewImg\",\n                  children: [\"T\\u1EA3i \\u1EA3nh\", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-upload\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 370,\n                    columnNumber: 28\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 369,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"preview-img\",\n                  style: {\n                    backgroundImage: `url(${this.state.thirdPreviewImgUrl})`\n                  },\n                  onClick: () => this.openPreviewThirdImage()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12 my-3\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: this.state.action === CRUD_ACTIONS.EDIT ? \"btn btn-warning\" : \"btn btn-primary\",\n                onClick: () => this.handleSaveProduct(),\n                children: this.state.action === CRUD_ACTIONS.EDIT ? \"Cập nhật\" : \"Lưu\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: /*#__PURE__*/_jsxDEV(TableManageProduct, {\n                handleEditProductFromParent: this.handleEditProductFromParent,\n                action: this.state.action\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 395,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), this.state.isOpen === true && /*#__PURE__*/_jsxDEV(Lightbox, {\n        mainSrc: this.state.previewImgUrl,\n        nextSrc: this.state.secondPreviewImgUrl,\n        prevSrc: this.state.thirdPreviewImgUrl,\n        onCloseRequest: () => this.setState({\n          isOpen: false\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    stockRedux: state.product.stocks,\n    isLoadingStock: state.product.isLoadingStock,\n    listProducts: state.product.products\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getStockStart: () => dispatch(actions.fetchStockStart()),\n    createNewProduct: data => dispatch(actions.createNewProduct(data)),\n    fetchProductRedux: () => dispatch(actions.fetchAllProductStart()),\n    editProductRedux: data => dispatch(actions.editProduct(data)) // processLogout: () => dispatch(actions.processLogout()),\n\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductRedux);","map":{"version":3,"sources":["D:/LienSon/LienSon-FE/src/containers/System/Admin/ProductRedux.js"],"names":["React","Component","connect","actions","Lightbox","TableManageProduct","CRUD_ACTIONS","CommonUtils","ProductRedux","constructor","props","handleOnChangeImage","event","data","target","files","file","base64","getBase64","objectUrl","URL","createObjectURL","setState","previewImgUrl","image","handleOnChangeSecondImage","secondBase64","secondObjectUrl","secondPreviewImgUrl","secondImage","handleOnChangeThirdImage","thirdBase64","thirdObjectUrl","thirdPreviewImgUrl","thirdImage","openPreviewImage","state","isOpen","openPreviewSecondImage","openPreviewThirdImage","handleSaveProduct","isValid","checkValidateInput","action","CREATE","createNewProduct","name","price","discount","describe","stockId","stock","type","EDIT","editProductRedux","id","productEditId","arrCheck","i","length","alert","onChangeInput","copyState","value","handleEditProductFromParent","product","imageBase64","secondImageBase64","thirdImageBase64","Buffer","from","toString","stockArr","componentDidMount","getStockStart","componentDidUpdate","prevProps","prevState","snapshot","stockRedux","arrStocks","keyMap","listProducts","render","stocks","map","item","index","valueVi","backgroundImage","mapStateToProps","isLoadingStock","products","mapDispatchToProps","dispatch","fetchStockStart","fetchProductRedux","fetchAllProductStart","editProduct"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport * as actions from \"../../../store/actions\";\r\nimport \"./ProductRedux.scss\";\r\nimport Lightbox from \"react-image-lightbox\";\r\nimport \"react-image-lightbox/style.css\";\r\nimport TableManageProduct from \"./TableManageProduct\";\r\nimport { CRUD_ACTIONS, CommonUtils } from \"../../../utils\";\r\n\r\nclass ProductRedux extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      stockArr: [],\r\n      previewImgUrl: \"\",\r\n      secondPreviewImgUrl: \"\",\r\n      thirdPreviewImgUrl: \"\",\r\n\r\n      name: \"\",\r\n      price: \"\",\r\n      discount: \"0\",\r\n      stock: \"\",\r\n      describe: \"\",\r\n      type: \"\",\r\n      image: \"\",\r\n      secondImage: \"\",\r\n      thirdImage: \"\",\r\n\r\n      action: \"\",\r\n      productEditId: \"\",\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    this.props.getStockStart();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.stockRedux !== this.props.stockRedux) {\r\n      let arrStocks = this.props.stockRedux;\r\n      this.setState({\r\n        stockArr: this.props.stockRedux,\r\n        stock: arrStocks && arrStocks.length > 0 ? arrStocks[0].keyMap : \"\",\r\n      });\r\n    }\r\n\r\n    if (prevProps.listProducts !== this.props.listProducts) {\r\n      let arrStocks = this.props.stockRedux;\r\n      this.setState({\r\n        name: \"\",\r\n        price: \"\",\r\n        discount: \"0\",\r\n        describe: \"\",\r\n        stock: arrStocks && arrStocks.length > 0 ? arrStocks[0].keyMap : \"\",\r\n        type: \"\",\r\n        image: \"\",\r\n        secondImage: \"\",\r\n        thirdImage: \"\",\r\n        action: CRUD_ACTIONS.CREATE,\r\n        previewImgUrl: \"\",\r\n        secondPreviewImgUrl: \"\",\r\n        thirdPreviewImgUrl: \"\",\r\n      });\r\n    }\r\n  }\r\n\r\n  handleOnChangeImage = async (event) => {\r\n    let data = event.target.files;\r\n    let file = data[0];\r\n    if (file) {\r\n      let base64 = await CommonUtils.getBase64(file);\r\n      let objectUrl = URL.createObjectURL(file);\r\n      this.setState({\r\n        previewImgUrl: objectUrl,\r\n        image: base64,\r\n      });\r\n    }\r\n  };\r\n\r\n  handleOnChangeSecondImage = async (event) => {\r\n    let data = event.target.files;\r\n    let file = data[0];\r\n    if (file) {\r\n      let secondBase64 = await CommonUtils.getBase64(file);\r\n      let secondObjectUrl = URL.createObjectURL(file);\r\n      this.setState({\r\n        secondPreviewImgUrl: secondObjectUrl,\r\n        secondImage: secondBase64,\r\n      });\r\n    }\r\n  };\r\n\r\n  handleOnChangeThirdImage = async (event) => {\r\n    let data = event.target.files;\r\n    let file = data[0];\r\n    if (file) {\r\n      let thirdBase64 = await CommonUtils.getBase64(file);\r\n      let thirdObjectUrl = URL.createObjectURL(file);\r\n      this.setState({\r\n        thirdPreviewImgUrl: thirdObjectUrl,\r\n        thirdImage: thirdBase64,\r\n      });\r\n    }\r\n  };\r\n\r\n  openPreviewImage = () => {\r\n    if (!this.state.previewImgUrl) return;\r\n    this.setState({\r\n      isOpen: true,\r\n    });\r\n  };\r\n\r\n  openPreviewSecondImage = () => {\r\n    if (!this.state.secondPreviewImgUrl) return;\r\n    this.setState({\r\n      isOpen: true,\r\n    });\r\n  };\r\n\r\n  openPreviewThirdImage = () => {\r\n    if (!this.state.thirdPreviewImgUrl) return;\r\n    this.setState({\r\n      isOpen: true,\r\n    });\r\n  };\r\n\r\n  handleSaveProduct = () => {\r\n    let isValid = this.checkValidateInput();\r\n    if (isValid === false) return;\r\n\r\n    let { action } = this.state;\r\n    if (action === CRUD_ACTIONS.CREATE) {\r\n      //fire redux create\r\n      this.props.createNewProduct({\r\n        name: this.state.name,\r\n        price: this.state.price,\r\n        discount: this.state.discount,\r\n        describe: this.state.describe,\r\n        stockId: this.state.stock,\r\n        type: this.state.type,\r\n        image: this.state.image,\r\n        secondImage: this.state.secondImage,\r\n        thirdImage: this.state.thirdImage,\r\n      });\r\n    }\r\n\r\n    if (action === CRUD_ACTIONS.EDIT) {\r\n      //fire redux edit\r\n      this.props.editProductRedux({\r\n        id: this.state.productEditId,\r\n        name: this.state.name,\r\n        price: this.state.price,\r\n        discount: this.state.discount,\r\n        describe: this.state.describe,\r\n        stockId: this.state.stock,\r\n        type: this.state.type,\r\n        image: this.state.image,\r\n        secondImage: this.state.secondImage,\r\n        thirdImage: this.state.thirdImage,\r\n      });\r\n    }\r\n  };\r\n\r\n  checkValidateInput = () => {\r\n    let isValid = true;\r\n    let arrCheck = [\"name\", \"price\", \"describe\", \"type\"];\r\n    for (let i = 0; i < arrCheck.length; i++) {\r\n      if (!this.state[arrCheck[i]]) {\r\n        isValid = false;\r\n        alert(\"Thông tin không được để trống: \" + arrCheck[i]);\r\n        break;\r\n      }\r\n    }\r\n    return isValid;\r\n  };\r\n\r\n  onChangeInput = (event, id) => {\r\n    let copyState = { ...this.state };\r\n    copyState[id] = event.target.value;\r\n    this.setState({\r\n      ...copyState,\r\n    });\r\n  };\r\n\r\n  handleEditProductFromParent = (product) => {\r\n    let imageBase64 = \"\";\r\n    let secondImageBase64 = \"\";\r\n    let thirdImageBase64 = \"\";\r\n    if (product.image) {\r\n      imageBase64 = new Buffer.from(product.image, \"base64\").toString(\"binary\");\r\n    }\r\n    if (product.secondImage) {\r\n      secondImageBase64 = new Buffer.from(\r\n        product.secondImage,\r\n        \"secondBase64\"\r\n      ).toString(\"binary\");\r\n    }\r\n    if (product.thirdImage) {\r\n      thirdImageBase64 = new Buffer.from(\r\n        product.thirdImage,\r\n        \"thirdBase64\"\r\n      ).toString(\"binary\");\r\n    }\r\n\r\n    this.setState({\r\n      name: product.name,\r\n      price: product.price,\r\n      discount: product.discount,\r\n      describe: product.describe,\r\n      stock: product.stockId,\r\n      type: product.type,\r\n      image: imageBase64,\r\n      secondImage: secondImageBase64,\r\n      thirdImage: thirdImageBase64,\r\n      previewImgUrl: imageBase64,\r\n      secondPreviewImgUrl: secondImageBase64,\r\n      thirdPreviewImgUrl: thirdImageBase64,\r\n      action: CRUD_ACTIONS.EDIT,\r\n      productEditId: product.id,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    let stocks = this.state.stockArr;\r\n    let { name, price, discount, describe, stock, type } = this.state;\r\n\r\n    return (\r\n      <div className=\"product-redux-container\">\r\n        <div className=\"title\">Quản lý sản phẩm</div>\r\n        <div className=\"body\">\r\n          <div className=\"container\">\r\n            <div className=\"row\">\r\n              <div className=\"col-12\">Thêm sản phẩm</div>\r\n              <div className=\"col-4\">\r\n                <label>Tên sản phẩm: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={name}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"name\");\r\n                  }}\r\n                // disabled={this.state.action === CRUD_ACTIONS.EDIT ? true : false}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-4\">\r\n                <label>Giá tiền: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={price}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"price\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-4\">\r\n                <label>Giá khuyến mãi: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={discount}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"discount\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Loại giấy: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={type}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"type\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Kho chứa: </label>\r\n                <select\r\n                  className=\"form-control\"\r\n                  value={stock}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"stock\");\r\n                  }}\r\n                >\r\n                  {stocks &&\r\n                    stocks.length > 0 &&\r\n                    stocks.map((item, index) => {\r\n                      return (\r\n                        <option key={index} value={item.keyMap}>\r\n                          {item.valueVi}\r\n                        </option>\r\n                      );\r\n                    })}\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"col-6\">\r\n                <label>Đơn vị tính: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={describe}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"describe\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Hình ảnh 1: </label>\r\n                <div className=\"preview-img-container\">\r\n                  <input\r\n                    id=\"previewImg\"\r\n                    type=\"file\"\r\n                    hidden\r\n                    onChange={(event) => this.handleOnChangeImage(event)}\r\n                  />\r\n                  <label className=\"label-upload\" htmlFor=\"previewImg\">\r\n                    Tải ảnh<i className=\"fas fa-upload\"></i>\r\n                  </label>\r\n                  <div\r\n                    className=\"preview-img\"\r\n                    style={{\r\n                      backgroundImage: `url(${this.state.previewImgUrl})`,\r\n                    }}\r\n                    onClick={() => this.openPreviewImage()}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Hình ảnh 2: </label>\r\n                <div className=\"preview-img-container\">\r\n                  <input\r\n                    id=\"secondPreviewImg\"\r\n                    type=\"file\"\r\n                    hidden\r\n                    onChange={(event) => this.handleOnChangeSecondImage(event)}\r\n                  />\r\n                  <label className=\"label-upload\" htmlFor=\"secondPreviewImg\">\r\n                    Tải ảnh<i className=\"fas fa-upload\"></i>\r\n                  </label>\r\n                  <div\r\n                    className=\"preview-img\"\r\n                    style={{\r\n                      backgroundImage: `url(${this.state.secondPreviewImgUrl})`,\r\n                    }}\r\n                    onClick={() => this.openPreviewSecondImage()}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Hình ảnh 3: </label>\r\n                <div className=\"preview-img-container\">\r\n                  <input\r\n                    id=\"thirdPreviewImg\"\r\n                    type=\"file\"\r\n                    hidden\r\n                    onChange={(event) => this.handleOnChangeThirdImage(event)}\r\n                  />\r\n                  <label className=\"label-upload\" htmlFor=\"thirdPreviewImg\">\r\n                    Tải ảnh<i className=\"fas fa-upload\"></i>\r\n                  </label>\r\n                  <div\r\n                    className=\"preview-img\"\r\n                    style={{\r\n                      backgroundImage: `url(${this.state.thirdPreviewImgUrl})`,\r\n                    }}\r\n                    onClick={() => this.openPreviewThirdImage()}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"col-12 my-3\">\r\n                <button\r\n                  className={\r\n                    this.state.action === CRUD_ACTIONS.EDIT\r\n                      ? \"btn btn-warning\"\r\n                      : \"btn btn-primary\"\r\n                  }\r\n                  onClick={() => this.handleSaveProduct()}\r\n                >\r\n                  {this.state.action === CRUD_ACTIONS.EDIT ? \"Cập nhật\" : \"Lưu\"}\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"col-12\">\r\n                <TableManageProduct\r\n                  handleEditProductFromParent={this.handleEditProductFromParent}\r\n                  action={this.state.action}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {this.state.isOpen === true && (\r\n          <Lightbox\r\n            mainSrc={this.state.previewImgUrl}\r\n            nextSrc={this.state.secondPreviewImgUrl}\r\n            prevSrc={this.state.thirdPreviewImgUrl}\r\n            onCloseRequest={() => this.setState({ isOpen: false })}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    stockRedux: state.product.stocks,\r\n\r\n    isLoadingStock: state.product.isLoadingStock,\r\n    listProducts: state.product.products,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    getStockStart: () => dispatch(actions.fetchStockStart()),\r\n    createNewProduct: (data) => dispatch(actions.createNewProduct(data)),\r\n    fetchProductRedux: () => dispatch(actions.fetchAllProductStart()),\r\n    editProductRedux: (data) => dispatch(actions.editProduct(data)),\r\n\r\n    // processLogout: () => dispatch(actions.processLogout()),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductRedux);\r\n"]},"metadata":{},"sourceType":"module"}