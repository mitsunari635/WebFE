{"ast":null,"code":"var _jsxFileName = \"D:\\\\LienSon\\\\LienSon-FE\\\\src\\\\containers\\\\System\\\\Admin\\\\UserRedux.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../store/actions\";\nimport \"./UserRedux.scss\";\nimport Lightbox from \"react-image-lightbox\";\nimport \"react-image-lightbox/style.css\";\nimport TableManageUser from \"./TableManageUser\";\nimport { CRUD_ACTIONS, CommonUtils } from \"../../../utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass UserRedux extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleOnChangeImage = async event => {\n      let data = event.target.files;\n      let file = data[0];\n\n      if (file) {\n        let base64 = await CommonUtils.getBase64(file);\n        let objectUrl = URL.createObjectURL(file);\n        this.setState({\n          previewImgUrl: objectUrl,\n          image: base64\n        });\n      }\n    };\n\n    this.openPreviewImage = () => {\n      if (!this.state.previewImgUrl) return;\n      this.setState({\n        isOpen: true\n      });\n    };\n\n    this.handleSaveUser = () => {\n      let isValid = this.checkValidateInput();\n      if (isValid === false) return;\n      let {\n        action\n      } = this.state;\n\n      if (action === CRUD_ACTIONS.CREATE) {\n        //fire redux create\n        this.props.createNewUser({\n          email: this.state.email,\n          password: this.state.password,\n          fullName: this.state.fullName,\n          receiveAddress: this.state.receiveAddress,\n          companyName: this.state.companyName,\n          companyAddress: this.state.companyAddress,\n          phoneNumber: this.state.phoneNumber,\n          taxNumber: this.state.taxNumber,\n          gender: this.state.gender,\n          roleId: this.state.role,\n          image: this.state.image\n        });\n      }\n\n      if (action === CRUD_ACTIONS.EDIT) {\n        //fire redux edit\n        this.props.editUserRedux({\n          id: this.state.userEditId,\n          email: this.state.email,\n          password: this.state.password,\n          fullName: this.state.fullName,\n          receiveAddress: this.state.receiveAddress,\n          companyName: this.state.companyName,\n          companyAddress: this.state.companyAddress,\n          phoneNumber: this.state.phoneNumber,\n          taxNumber: this.state.taxNumber,\n          gender: this.state.gender,\n          roleId: this.state.role,\n          image: this.state.image\n        });\n      }\n    };\n\n    this.checkValidateInput = () => {\n      let isValid = true;\n      let arrCheck = [\"email\", \"password\", \"fullName\", \"receiveAddress\", \"phoneNumber\" // \"companyName\",\n      // \"companyAddress\",\n      // \"taxNumber\",\n      ];\n\n      for (let i = 0; i < arrCheck.length; i++) {\n        if (!this.state[arrCheck[i]]) {\n          isValid = false;\n          alert(\"Thông tin không được để trống: \" + arrCheck[i]);\n          break;\n        }\n      }\n\n      return isValid;\n    };\n\n    this.onChangeInput = (event, id) => {\n      let copyState = { ...this.state\n      };\n      copyState[id] = event.target.value;\n      this.setState({ ...copyState\n      });\n    };\n\n    this.handleEditUserFromParent = user => {\n      let imageBase64 = \"\";\n\n      if (user.image) {\n        imageBase64 = new Buffer.from(user.image, \"base64\").toString(\"binary\");\n      }\n\n      this.setState({\n        email: user.email,\n        password: \"123456\",\n        fullName: user.fullName,\n        receiveAddress: user.receiveAddress,\n        companyName: user.companyName,\n        companyAddress: user.companyAddress,\n        phoneNumber: user.phoneNumber,\n        taxNumber: user.taxNumber,\n        gender: user.gender,\n        role: user.roleId,\n        image: \"\",\n        previewImgUrl: imageBase64,\n        action: CRUD_ACTIONS.EDIT,\n        userEditId: user.id\n      });\n    };\n\n    this.state = {\n      genderArr: [],\n      roleArr: [],\n      previewImgUrl: \"\",\n      email: \"\",\n      password: \"\",\n      fullName: \"\",\n      receiveAddress: \"\",\n      companyName: \"\",\n      companyAddress: \"\",\n      phoneNumber: \"\",\n      taxNumber: \"\",\n      gender: \"\",\n      role: \"\",\n      image: \"\",\n      action: \"\",\n      userEditId: \"\"\n    };\n  }\n\n  async componentDidMount() {\n    this.props.getGenderStart();\n    this.props.getRoleStart();\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (prevProps.genderRedux !== this.props.genderRedux) {\n      let arrGenders = this.props.genderRedux;\n      this.setState({\n        genderArr: this.props.genderRedux,\n        gender: arrGenders && arrGenders.length > 0 ? arrGenders[0].keyMap : \"\"\n      });\n    }\n\n    if (prevProps.roleRedux !== this.props.roleRedux) {\n      let arrRole = this.props.roleRedux;\n      this.setState({\n        roleArr: this.props.roleRedux,\n        role: arrRole && arrRole.length > 0 ? arrRole[0].keyMap : \"\"\n      });\n    }\n\n    if (prevProps.listUsers !== this.props.listUsers) {\n      let arrGenders = this.props.genderRedux;\n      let arrRole = this.props.roleRedux;\n      this.setState({\n        email: \"\",\n        password: \"\",\n        fullName: \"\",\n        receiveAddress: \"\",\n        companyName: \"\",\n        companyAddress: \"\",\n        phoneNumber: \"\",\n        taxNumber: \"\",\n        gender: arrGenders && arrGenders.length > 0 ? arrGenders[0].keyMap : \"\",\n        role: arrRole && arrRole.length > 0 ? arrRole[0].keyMap : \"\",\n        image: \"\",\n        action: CRUD_ACTIONS.CREATE,\n        previewImgUrl: \"\"\n      });\n    }\n  }\n\n  render() {\n    let genders = this.state.genderArr;\n    let roles = this.state.roleArr;\n    let {\n      email,\n      password,\n      fullName,\n      receiveAddress,\n      companyName,\n      companyAddress,\n      taxNumber,\n      phoneNumber,\n      gender,\n      role\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-redux-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title\",\n        children: \"Qu\\u1EA3n l\\xFD ng\\u01B0\\u1EDDi d\\xF9ng\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: \"Th\\xEAm ng\\u01B0\\u1EDDi d\\xF9ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Email: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"email\",\n                value: email,\n                onChange: event => {\n                  this.onChangeInput(event, \"email\");\n                } // disabled={\n                //   this.state.action === CRUD_ACTIONS.EDIT ? true : false\n                // }\n\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 219,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"M\\u1EADt kh\\u1EA9u: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"password\",\n                value: password,\n                onChange: event => {\n                  this.onChangeInput(event, \"password\");\n                } // disabled={\n                //   this.state.action === CRUD_ACTIONS.EDIT ? true : false\n                // }\n\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"H\\u1ECD, t\\xEAn : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: fullName,\n                onChange: event => {\n                  this.onChangeInput(event, \"fullName\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"\\u0110\\u1ECBa ch\\u1EC9 nh\\u1EADn h\\xE0ng : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: receiveAddress,\n                onChange: event => {\n                  this.onChangeInput(event, \"receiveAddress\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"T\\xEAn c\\xF4ng ty: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: companyName,\n                onChange: event => {\n                  this.onChangeInput(event, \"companyName\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-9\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"\\u0110\\u1ECBa ch\\u1EC9 c\\xF4ng ty: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: companyAddress,\n                onChange: event => {\n                  this.onChangeInput(event, \"companyAddress\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"M\\xE3 s\\u1ED1 thu\\u1EBF: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: taxNumber,\n                onChange: event => {\n                  this.onChangeInput(event, \"taxNumber\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 308,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                type: \"text\",\n                value: phoneNumber,\n                onChange: event => {\n                  this.onChangeInput(event, \"phoneNumber\");\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 309,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Gi\\u1EDBi t\\xEDnh: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"form-control\",\n                onChange: event => {\n                  this.onChangeInput(event, \"gender\");\n                },\n                value: gender,\n                children: genders && genders.length > 0 && genders.map((item, index) => {\n                  return /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: item.keyMap,\n                    children: item.valueVi\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 332,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Vai tr\\xF2: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"form-control\",\n                onChange: event => {\n                  this.onChangeInput(event, \"role\");\n                },\n                value: role,\n                children: roles && roles.length > 0 && roles.map((item, index) => {\n                  return /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: item.keyMap,\n                    children: item.valueVi\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 353,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"H\\xECnh \\u1EA3nh: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"preview-img-container\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"previewImg\",\n                  type: \"file\",\n                  hidden: true,\n                  onChange: event => this.handleOnChangeImage(event)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 364,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"label-upload\",\n                  htmlFor: \"previewImg\",\n                  children: [\"T\\u1EA3i \\u1EA3nh\", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-upload\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 371,\n                    columnNumber: 28\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"preview-img\",\n                  style: {\n                    backgroundImage: `url(${this.state.previewImgUrl})`\n                  },\n                  onClick: () => this.openPreviewImage()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 373,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12 my-3\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: this.state.action === CRUD_ACTIONS.EDIT ? \"btn btn-warning\" : \"btn btn-primary\",\n                onClick: () => this.handleSaveUser(),\n                children: this.state.action === CRUD_ACTIONS.EDIT ? \"Cập nhật\" : \"Lưu\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: /*#__PURE__*/_jsxDEV(TableManageUser, {\n                handleEditUserFromParent: this.handleEditUserFromParent,\n                action: this.state.action\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), this.state.isOpen === true && /*#__PURE__*/_jsxDEV(Lightbox, {\n        mainSrc: this.state.previewImgUrl,\n        onCloseRequest: () => this.setState({\n          isOpen: false\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    genderRedux: state.admin.genders,\n    roleRedux: state.admin.roles,\n    isLoadingGender: state.admin.isLoadingGender,\n    listUsers: state.admin.users\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getGenderStart: () => dispatch(actions.fetchGenderStart()),\n    getRoleStart: () => dispatch(actions.fetchRoleStart()),\n    createNewUser: data => dispatch(actions.createNewUser(data)),\n    fetchUserRedux: () => dispatch(actions.fetchAllUserStart()),\n    editUserRedux: data => dispatch(actions.editUser(data)) // processLogout: () => dispatch(actions.processLogout()),\n\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserRedux);","map":{"version":3,"sources":["D:/LienSon/LienSon-FE/src/containers/System/Admin/UserRedux.js"],"names":["React","Component","connect","actions","Lightbox","TableManageUser","CRUD_ACTIONS","CommonUtils","UserRedux","constructor","props","handleOnChangeImage","event","data","target","files","file","base64","getBase64","objectUrl","URL","createObjectURL","setState","previewImgUrl","image","openPreviewImage","state","isOpen","handleSaveUser","isValid","checkValidateInput","action","CREATE","createNewUser","email","password","fullName","receiveAddress","companyName","companyAddress","phoneNumber","taxNumber","gender","roleId","role","EDIT","editUserRedux","id","userEditId","arrCheck","i","length","alert","onChangeInput","copyState","value","handleEditUserFromParent","user","imageBase64","Buffer","from","toString","genderArr","roleArr","componentDidMount","getGenderStart","getRoleStart","componentDidUpdate","prevProps","prevState","snapshot","genderRedux","arrGenders","keyMap","roleRedux","arrRole","listUsers","render","genders","roles","map","item","index","valueVi","backgroundImage","mapStateToProps","admin","isLoadingGender","users","mapDispatchToProps","dispatch","fetchGenderStart","fetchRoleStart","fetchUserRedux","fetchAllUserStart","editUser"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport * as actions from \"../../../store/actions\";\r\nimport \"./UserRedux.scss\";\r\nimport Lightbox from \"react-image-lightbox\";\r\nimport \"react-image-lightbox/style.css\";\r\nimport TableManageUser from \"./TableManageUser\";\r\nimport { CRUD_ACTIONS, CommonUtils } from \"../../../utils\";\r\n\r\nclass UserRedux extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      genderArr: [],\r\n      roleArr: [],\r\n      previewImgUrl: \"\",\r\n\r\n      email: \"\",\r\n      password: \"\",\r\n      fullName: \"\",\r\n      receiveAddress: \"\",\r\n      companyName: \"\",\r\n      companyAddress: \"\",\r\n      phoneNumber: \"\",\r\n      taxNumber: \"\",\r\n      gender: \"\",\r\n      role: \"\",\r\n      image: \"\",\r\n\r\n      action: \"\",\r\n      userEditId: \"\",\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    this.props.getGenderStart();\r\n    this.props.getRoleStart();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.genderRedux !== this.props.genderRedux) {\r\n      let arrGenders = this.props.genderRedux;\r\n      this.setState({\r\n        genderArr: this.props.genderRedux,\r\n        gender: arrGenders && arrGenders.length > 0 ? arrGenders[0].keyMap : \"\",\r\n      });\r\n    }\r\n\r\n    if (prevProps.roleRedux !== this.props.roleRedux) {\r\n      let arrRole = this.props.roleRedux;\r\n\r\n      this.setState({\r\n        roleArr: this.props.roleRedux,\r\n        role: arrRole && arrRole.length > 0 ? arrRole[0].keyMap : \"\",\r\n      });\r\n    }\r\n\r\n    if (prevProps.listUsers !== this.props.listUsers) {\r\n      let arrGenders = this.props.genderRedux;\r\n      let arrRole = this.props.roleRedux;\r\n      this.setState({\r\n        email: \"\",\r\n        password: \"\",\r\n        fullName: \"\",\r\n        receiveAddress: \"\",\r\n        companyName: \"\",\r\n        companyAddress: \"\",\r\n        phoneNumber: \"\",\r\n        taxNumber: \"\",\r\n        gender: arrGenders && arrGenders.length > 0 ? arrGenders[0].keyMap : \"\",\r\n        role: arrRole && arrRole.length > 0 ? arrRole[0].keyMap : \"\",\r\n        image: \"\",\r\n        action: CRUD_ACTIONS.CREATE,\r\n        previewImgUrl: \"\",\r\n      });\r\n    }\r\n  }\r\n\r\n  handleOnChangeImage = async (event) => {\r\n    let data = event.target.files;\r\n    let file = data[0];\r\n    if (file) {\r\n      let base64 = await CommonUtils.getBase64(file);\r\n      let objectUrl = URL.createObjectURL(file);\r\n      this.setState({\r\n        previewImgUrl: objectUrl,\r\n        image: base64,\r\n      });\r\n    }\r\n  };\r\n\r\n  openPreviewImage = () => {\r\n    if (!this.state.previewImgUrl) return;\r\n    this.setState({\r\n      isOpen: true,\r\n    });\r\n  };\r\n\r\n  handleSaveUser = () => {\r\n    let isValid = this.checkValidateInput();\r\n    if (isValid === false) return;\r\n\r\n    let { action } = this.state;\r\n    if (action === CRUD_ACTIONS.CREATE) {\r\n      //fire redux create\r\n      this.props.createNewUser({\r\n        email: this.state.email,\r\n        password: this.state.password,\r\n        fullName: this.state.fullName,\r\n        receiveAddress: this.state.receiveAddress,\r\n        companyName: this.state.companyName,\r\n        companyAddress: this.state.companyAddress,\r\n        phoneNumber: this.state.phoneNumber,\r\n        taxNumber: this.state.taxNumber,\r\n        gender: this.state.gender,\r\n        roleId: this.state.role,\r\n        image: this.state.image,\r\n      });\r\n    }\r\n\r\n    if (action === CRUD_ACTIONS.EDIT) {\r\n      //fire redux edit\r\n      this.props.editUserRedux({\r\n        id: this.state.userEditId,\r\n        email: this.state.email,\r\n        password: this.state.password,\r\n        fullName: this.state.fullName,\r\n        receiveAddress: this.state.receiveAddress,\r\n        companyName: this.state.companyName,\r\n        companyAddress: this.state.companyAddress,\r\n        phoneNumber: this.state.phoneNumber,\r\n        taxNumber: this.state.taxNumber,\r\n        gender: this.state.gender,\r\n        roleId: this.state.role,\r\n        image: this.state.image,\r\n      });\r\n    }\r\n  };\r\n\r\n  checkValidateInput = () => {\r\n    let isValid = true;\r\n    let arrCheck = [\r\n      \"email\",\r\n      \"password\",\r\n      \"fullName\",\r\n      \"receiveAddress\",\r\n      \"phoneNumber\",\r\n      // \"companyName\",\r\n      // \"companyAddress\",\r\n      // \"taxNumber\",\r\n    ];\r\n    for (let i = 0; i < arrCheck.length; i++) {\r\n      if (!this.state[arrCheck[i]]) {\r\n        isValid = false;\r\n        alert(\"Thông tin không được để trống: \" + arrCheck[i]);\r\n        break;\r\n      }\r\n    }\r\n    return isValid;\r\n  };\r\n\r\n  onChangeInput = (event, id) => {\r\n    let copyState = { ...this.state };\r\n    copyState[id] = event.target.value;\r\n    this.setState({\r\n      ...copyState,\r\n    });\r\n  };\r\n\r\n  handleEditUserFromParent = (user) => {\r\n    let imageBase64 = \"\";\r\n    if (user.image) {\r\n      imageBase64 = new Buffer.from(user.image, \"base64\").toString(\"binary\");\r\n    }\r\n\r\n    this.setState({\r\n      email: user.email,\r\n      password: \"123456\",\r\n      fullName: user.fullName,\r\n      receiveAddress: user.receiveAddress,\r\n      companyName: user.companyName,\r\n      companyAddress: user.companyAddress,\r\n      phoneNumber: user.phoneNumber,\r\n      taxNumber: user.taxNumber,\r\n      gender: user.gender,\r\n      role: user.roleId,\r\n      image: \"\",\r\n      previewImgUrl: imageBase64,\r\n      action: CRUD_ACTIONS.EDIT,\r\n      userEditId: user.id,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    let genders = this.state.genderArr;\r\n    let roles = this.state.roleArr;\r\n    let {\r\n      email,\r\n      password,\r\n      fullName,\r\n      receiveAddress,\r\n      companyName,\r\n      companyAddress,\r\n      taxNumber,\r\n      phoneNumber,\r\n      gender,\r\n      role,\r\n    } = this.state;\r\n\r\n    return (\r\n      <div className=\"user-redux-container\">\r\n        <div className=\"title\">Quản lý người dùng</div>\r\n        <div className=\"body\">\r\n          <div className=\"container\">\r\n            <div className=\"row\">\r\n              <div className=\"col-12\">Thêm người dùng</div>\r\n              <div className=\"col-3\">\r\n                <label>Email: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"email\"\r\n                  value={email}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"email\");\r\n                  }}\r\n                // disabled={\r\n                //   this.state.action === CRUD_ACTIONS.EDIT ? true : false\r\n                // }\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Mật khẩu: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"password\"\r\n                  value={password}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"password\");\r\n                  }}\r\n                // disabled={\r\n                //   this.state.action === CRUD_ACTIONS.EDIT ? true : false\r\n                // }\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Họ, tên : </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={fullName}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"fullName\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Địa chỉ nhận hàng : </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={receiveAddress}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"receiveAddress\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Tên công ty: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={companyName}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"companyName\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-9\">\r\n                <label>Địa chỉ công ty: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={companyAddress}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"companyAddress\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Mã số thuế: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={taxNumber}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"taxNumber\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Số điện thoại: </label>\r\n                <input\r\n                  className=\"form-control\"\r\n                  type=\"text\"\r\n                  value={phoneNumber}\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"phoneNumber\");\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Giới tính: </label>\r\n                <select\r\n                  className=\"form-control\"\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"gender\");\r\n                  }}\r\n                  value={gender}\r\n                >\r\n                  {genders &&\r\n                    genders.length > 0 &&\r\n                    genders.map((item, index) => {\r\n                      return (\r\n                        <option key={index} value={item.keyMap}>\r\n                          {item.valueVi}\r\n                        </option>\r\n                      );\r\n                    })}\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Vai trò: </label>\r\n                <select\r\n                  className=\"form-control\"\r\n                  onChange={(event) => {\r\n                    this.onChangeInput(event, \"role\");\r\n                  }}\r\n                  value={role}\r\n                >\r\n                  {roles &&\r\n                    roles.length > 0 &&\r\n                    roles.map((item, index) => {\r\n                      return (\r\n                        <option key={index} value={item.keyMap}>\r\n                          {item.valueVi}\r\n                        </option>\r\n                      );\r\n                    })}\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"col-3\">\r\n                <label>Hình ảnh: </label>\r\n                <div className=\"preview-img-container\">\r\n                  <input\r\n                    id=\"previewImg\"\r\n                    type=\"file\"\r\n                    hidden\r\n                    onChange={(event) => this.handleOnChangeImage(event)}\r\n                  />\r\n                  <label className=\"label-upload\" htmlFor=\"previewImg\">\r\n                    Tải ảnh<i className=\"fas fa-upload\"></i>\r\n                  </label>\r\n                  <div\r\n                    className=\"preview-img\"\r\n                    style={{\r\n                      backgroundImage: `url(${this.state.previewImgUrl})`,\r\n                    }}\r\n                    onClick={() => this.openPreviewImage()}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"col-12 my-3\">\r\n                <button\r\n                  className={\r\n                    this.state.action === CRUD_ACTIONS.EDIT\r\n                      ? \"btn btn-warning\"\r\n                      : \"btn btn-primary\"\r\n                  }\r\n                  onClick={() => this.handleSaveUser()}\r\n                >\r\n                  {this.state.action === CRUD_ACTIONS.EDIT ? \"Cập nhật\" : \"Lưu\"}\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"col-12\">\r\n                <TableManageUser\r\n                  handleEditUserFromParent={this.handleEditUserFromParent}\r\n                  action={this.state.action}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {this.state.isOpen === true && (\r\n          <Lightbox\r\n            mainSrc={this.state.previewImgUrl}\r\n            onCloseRequest={() => this.setState({ isOpen: false })}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    genderRedux: state.admin.genders,\r\n    roleRedux: state.admin.roles,\r\n\r\n    isLoadingGender: state.admin.isLoadingGender,\r\n    listUsers: state.admin.users,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    getGenderStart: () => dispatch(actions.fetchGenderStart()),\r\n    getRoleStart: () => dispatch(actions.fetchRoleStart()),\r\n    createNewUser: (data) => dispatch(actions.createNewUser(data)),\r\n    fetchUserRedux: () => dispatch(actions.fetchAllUserStart()),\r\n    editUserRedux: (data) => dispatch(actions.editUser(data)),\r\n\r\n    // processLogout: () => dispatch(actions.processLogout()),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserRedux);\r\n"]},"metadata":{},"sourceType":"module"}